<!-- File: base.html -->
<!-- Author: Bill Jiao (jiaobill@bu.edu), 12/8/2024 -->
<!-- Description: Base template for the HackerMap application - provides the main -->
<!--              layout structure, sidebar navigation, and user profile widget. -->

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}HackerMap{% endblock %}</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'project/styles.css' %}">
</head>

<body>
    <!-- Profile Avatar (only visible when logged in) -->
    {% if user.is_authenticated %}
    <div class="user-profile-widget">
        <a href="{% url 'user_profile_detail' user.pk %}" class="profile-widget-link">
            <div class="profile-widget-avatar">
                {% if user.profile.avatar %}
                    <img src="{{ user.profile.avatar.url }}" alt="{{ user.username }}">
                {% else %}
                    <span class="profile-widget-initial">{{ user.username|slice:":1"|upper }}</span>
                {% endif %}
            </div>
            <span class="profile-widget-name">{{ user.username }}</span>
        </a>
        <form action="{% url 'logout' %}" method="post" class="logout-form-inline">
            {% csrf_token %}
            <button type="submit" class="profile-widget-logout" title="Logout">
                <span>â†—</span>
            </button>
        </form>
    </div>
    {% endif %}

    <!-- Sidebar Toggle -->
    <input type="checkbox" id="sidebar-toggle" class="sidebar-checkbox">
    <label for="sidebar-toggle" class="sidebar-trigger">
        <span class="trigger-bar"></span>
        <span class="trigger-bar"></span>
        <span class="trigger-bar"></span>
    </label>

    <!-- Sidebar Overlay -->
    <label for="sidebar-toggle" class="sidebar-overlay"></label>

    <!-- Sidebar Navigation -->
    <nav class="sidebar">
        <div class="sidebar-header">
            <span class="sidebar-logo">âŒ‚</span>
            <span class="sidebar-brand">HackerMap</span>
        </div>

        <ul class="sidebar-nav">
            <li class="sidebar-item">
                <a href="{% url 'hackerhouse_list' %}" class="sidebar-link">
                    <span class="sidebar-icon">ğŸ </span>
                    <span class="sidebar-text">Home</span>
                </a>
            </li>
            <li class="sidebar-item">
                <a href="{% url 'event_calendar' %}" class="sidebar-link">
                    <span class="sidebar-icon">ğŸ“…</span>
                    <span class="sidebar-text">Events</span>
                </a>
            </li>
            <li class="sidebar-item">
                <a href="{% url 'followings' %}" class="sidebar-link">
                    <span class="sidebar-icon">â˜…</span>
                    <span class="sidebar-text">Following</span>
                </a>
            </li>
        </ul>

        <div class="sidebar-divider"></div>

        <ul class="sidebar-nav sidebar-auth">
            {% if user.is_authenticated %}
            <li class="sidebar-item">
                <a href="{% url 'user_profile_detail' user.pk %}" class="sidebar-link">
                    <span class="sidebar-icon">â—</span>
                    <span class="sidebar-text">{{ user.username }}</span>
                </a>
            </li>
            <li class="sidebar-item">
                <form action="{% url 'logout' %}" method="post" class="logout-form-inline">
                    {% csrf_token %}
                    <button type="submit" class="sidebar-link sidebar-link-logout">
                        <span class="sidebar-icon">â†</span>
                        <span class="sidebar-text">Logout</span>
                    </button>
                </form>
            </li>
            {% else %}
            <li class="sidebar-item">
                <a href="{% url 'login' %}" class="sidebar-link">
                    <span class="sidebar-icon">â†’</span>
                    <span class="sidebar-text">Login</span>
                </a>
            </li>
            <li class="sidebar-item">
                <a href="{% url 'create_account' %}" class="sidebar-link sidebar-link-accent">
                    <span class="sidebar-icon">+</span>
                    <span class="sidebar-text">Create Account</span>
                </a>
            </li>
            {% endif %}
        </ul>
    </nav>

    <!-- Main Content Container - Content from child templates injected here -->
    <main class="main-content">
        {% block content %}{% endblock %}
    </main>
</body>

</html>
